{% load bootstrap4 %}
{% load static %}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    {% bootstrap_css %}
    {% bootstrap_javascript jquery='full' %}
    {# Display django.contrib.messages as Bootstrap alerts #}
    {% bootstrap_messages %}
    <meta charset="UTF-8">
    <title>登录</title>
</head>
<body style="background-color: #eeeeee">
    <div class="text-center">
        <img src="{% static 'pic/site_img.png' %}" style="height: 120px;margin-top: 30px">
    </div>
    <h2 class="text-center"style="margin-top: 20px">用户登录</h2>
    <div class="card m-auto" style="width:400px">
        <div class="card-img-overlay">
            <form method="post" action="{% url 'login_check' %}" enctype="multipart/form-data">
                {% csrf_token %}
                {% bootstrap_form loginform %}
                <p id="message" style="color:red;"></p>
                <br>
                <button class="btn btn-lg btn-primary btn-block" type="submit">登录</button>
            </form>
        </div>
    </div>




<div class="container">

</div>





<script type="text/javascript">
function loginform_ajax() {
    let username = $('input[name=username]')[0].value;
    let password = $('input[name=password]')[0].value;

    $.get('/login_check/', {'username': username, 'password': password},
    function (ret) {
        if(ret == 'no_username'){
            $('#id_username').removeClass('text-success');
            $('#id_username').addClass('text-danger');
            $('#message').text('用户名不存在！');
        }
        else if(ret == 'no_password'){
            $('#id_username').removeClass('text-danger');
            $('#id_username').addClass('text-success');
            $('#id_password').removeClass('text-success');
            $('#id_password').addClass('text-danger');
            $('#message').text('密码错误！');
        }
        else if(ret == 'no_loginform'){
            $('#message').text('登录表单获取失败！');
        }
        else if(ret == 'success'){
            $('#id_username').removeClass('text-danger');
            $('#id_username').addClass('text-success');
            $('#id_password').removeClass('text-danger');
            $('#id_password').addClass('text-success');
            $('#message').text('');
        }
    });
}
</script>
</body>
</html>